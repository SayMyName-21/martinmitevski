<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Car Charts</title>
    <script src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>
</head>

<body>

<form>
    <input type="radio" id="hor" name="option" value="horizontal">
    <label for="hor">Horizontal bar chart</label><br>
    <input type="radio" id="vert" name="option" value="vertical">
    <label for="vert">Vertical bar chart</label><br>
    <input type="radio" id="line" name="option" value="line">
    <label for="line">Line graph</label>
</form>

<button type="button" onclick="generateGraph()">Generate</button>

<div id="plot"></div>

<script>
    let cars = []
    let names = []
    let years = []

    fetch("cars.json")
        .then(response => response.json())
        .then(data => {
            cars = data
            names = cars.map(car => car.name)
            years = cars.map(car => car.year)
        })
        .catch(error => console.error("Error", error))

    function generateGraph() {
        if (cars.length === 0) {
            return alert("JSON ne e loadiran!")
        }

        let option = ""
        let radios = document.getElementsByTagName("input")

        for (let radio of radios) {
            if (radio.checked) {
                option = radio.value
            }
        }

        let data

        if (option === "horizontal") {
            data = [{
                x: years,
                y: names,
                type: "bar",
                orientation: "h"
            }]
        } else if (option === "vertical") {
            data = [{
                x: names,
                y: years,
                type: "bar"
            }]
        } else if (option === "line") {
            data = [{
                x: names,
                y: years,
                type: "scatter",
                mode: "lines+markers"
            }]
        } else {
            return alert("Odberi edno.")
        }

        Plotly.newPlot("plot", data)
    }
</script>
</body>
</html>
